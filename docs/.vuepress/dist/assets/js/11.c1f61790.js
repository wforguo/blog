(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{211:function(e,n,t){"use strict";t.r(n);var r=t(0),s=Object(r.a)({},(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"jenkins-gitlab持续集成打包平台搭建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-gitlab持续集成打包平台搭建"}},[e._v("#")]),e._v(" Jenkins Gitlab持续集成打包平台搭建")]),e._v(" "),t("h1",{attrs:{id:"相关概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#相关概念"}},[e._v("#")]),e._v(" 相关概念")]),e._v(" "),t("h2",{attrs:{id:"jenkins"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins"}},[e._v("#")]),e._v(" Jenkins")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://jenkins.io/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Jenkins"),t("OutboundLink")],1),e._v("，一个用Java编写的开源的持续集成工具，提供了软件开发的持续集成服务，可监控并触发持续重复的工作，具有开源，支持多平台和插件扩展，安装简单，界面化管理等特点。更多介绍参考[维基](https://en.wikipedia.org/wiki/Jenkins_(software)介绍.")])]),e._v(" "),t("h2",{attrs:{id:"gitlab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gitlab"}},[e._v("#")]),e._v(" Gitlab")]),e._v(" "),t("ul",[t("li",[e._v("GitLab是一个利用Ruby on Rails开发的开源应用程序，实现一个自托管的Git项目仓库，可通过Web界面进行访问公开的或者私人项目，更多介绍参考"),t("a",{attrs:{href:"https://en.wikipedia.org/wiki/GitLab",target:"_blank",rel:"noopener noreferrer"}},[e._v("维基"),t("OutboundLink")],1),e._v("介绍.")])]),e._v(" "),t("h2",{attrs:{id:"ci"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ci"}},[e._v("#")]),e._v(" CI")]),e._v(" "),t("ul",[t("li",[e._v("持续集成, 简称CI（continuous integration）.")]),e._v(" "),t("li",[e._v("CI作为敏捷开发重要的一步，其目的在于让产品快速迭代的同时，尽可能保持高质量.")]),e._v(" "),t("li",[e._v("CI一种可以增加项目可见性，降低项目失败风险的开发实践。其每一次代码更新，都要通过自动化测试来检测代码和功能的正确性，只有通过自动测试的代码才能进行后续的交付和部署.")]),e._v(" "),t("li",[e._v("CI 是团队成员间（产研测）更好地协调工作，更好的适应敏捷迭代开发，自动完成减少人工干预，保证每个时间点上团队成员提交的代码都能成功集成的，可以很好的用于对Android/iOS项目的打包.")])]),e._v(" "),t("h2",{attrs:{id:"ota"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ota"}},[e._v("#")]),e._v(" OTA")]),e._v(" "),t("ul",[t("li",[e._v("OTA（Over-the-Air Technology）空中下载技术,具体参"),t("a",{attrs:{href:"https://support.apple.com/en-us/HT201435",target:"_blank",rel:"noopener noreferrer"}},[e._v("考此文介绍"),t("OutboundLink")],1),e._v(".")])]),e._v(" "),t("h2",{attrs:{id:"pgyer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pgyer"}},[e._v("#")]),e._v(" pgyer")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.pgyer.com/apps",target:"_blank",rel:"noopener noreferrer"}},[e._v("蒲公英(pgyer)"),t("OutboundLink")],1),e._v("为移动开发者提供App免费测试分发应用的服务平台，支持iOS与Android，简单两步分发应用。类似的还有fir.im等.")])]),e._v(" "),t("h1",{attrs:{id:"流程结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#流程结构"}},[e._v("#")]),e._v(" 流程结构")]),e._v(" "),t("p",[e._v("简单绘制了下Jenkins的一个流程，如下图：")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E6%B5%81%E7%A8%8B-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E6%B5%81%E7%A8%8B-min.png",alt:"img"}}),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"http://www.ibm.com/developerworks/cn/devops/d-continuous-delivery-framework-jenkins/",target:"_blank",rel:"noopener noreferrer"}},[e._v("IBM Developer"),t("OutboundLink")],1),e._v("上也有一个看似更复杂一点的图，如下图\n"),t("a",{attrs:{href:"http://www.ibm.com/developerworks/cn/devops/d-continuous-delivery-framework-jenkins/image007.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://www.ibm.com/developerworks/cn/devops/d-continuous-delivery-framework-jenkins/image007.png",alt:"img"}}),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("持续交互流程图：\n"),t("a",{attrs:{href:"http://www.ibm.com/developerworks/cn/devops/d-continuous-delivery-framework-jenkins/image006.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://www.ibm.com/developerworks/cn/devops/d-continuous-delivery-framework-jenkins/image006.png",alt:"img"}}),t("OutboundLink")],1)]),e._v(" "),t("h1",{attrs:{id:"平台搭建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#平台搭建"}},[e._v("#")]),e._v(" 平台搭建")]),e._v(" "),t("h2",{attrs:{id:"jenkins安装和启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins安装和启动"}},[e._v("#")]),e._v(" Jenkins安装和启动")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://jenkins.io/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("官网"),t("OutboundLink")],1),e._v("： "),t("a",{attrs:{href:"https://jenkins.io/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://jenkins.io/index.html"),t("OutboundLink")],1),e._v(" "),t("a",{attrs:{href:"http://mirrors.jenkins-ci.org/war/latest/jenkins.war",target:"_blank",rel:"noopener noreferrer"}},[e._v("下载"),t("OutboundLink")],1),e._v("： "),t("a",{attrs:{href:"http://mirrors.jenkins-ci.org/war/latest/jenkins.war",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://mirrors.jenkins-ci.org/war/latest/jenkins.war"),t("OutboundLink")],1)]),e._v(" "),t("blockquote",[t("p",[e._v("安装：")])]),e._v(" "),t("ul",[t("li",[e._v("依赖于Java环境，首先安装和配置"),t("a",{attrs:{href:"http://www.oracle.com/technetwork/java/javase/downloads/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Java环境"),t("OutboundLink")],1)]),e._v(" "),t("li",[e._v("到"),t("a",{attrs:{href:"https://jenkins.io/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("官网"),t("OutboundLink")],1),e._v("下载Jenkins,双击安装，如果是Mac电脑，会自动生成全局变量jenkins")]),e._v(" "),t("li",[e._v("修改参数： jenkins + 相关参数，如\njenkins –httpPort=8888 #更换端口号，当默认端口8080被占用，或指定特定端口时。")])]),e._v(" "),t("blockquote",[t("p",[e._v("启动")])]),e._v(" "),t("ul",[t("li",[e._v("手动启动： java -jar jenkins.war")]),e._v(" "),t("li",[e._v("后台启动(默认端口)： nohup java -jar jenkins.war &")]),e._v(" "),t("li",[e._v("后台启动(指定端口)： nohup java -jar jenkins.war -httpPort=88 &")]),e._v(" "),t("li",[e._v("后台启动(HTTPS)： nohup java -jar jenkins.war -httpsPort=88 &")]),e._v(" "),t("li",[e._v("浏览："),t("a",{attrs:{href:"http://localhost:8080/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:8080/"),t("OutboundLink")],1),e._v(" , localhost可配置")])]),e._v(" "),t("h2",{attrs:{id:"jenkins插件安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins插件安装"}},[e._v("#")]),e._v(" Jenkins插件安装")]),e._v(" "),t("blockquote",[t("p",[e._v("插件安装")])]),e._v(" "),t("p",[e._v("操作： Manage Jenkins -> Manage Plugins -> Available -> Search -> Click to install，如下图所示")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%851-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%851-min.png",alt:"img"}}),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%852-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%852-min.png",alt:"img"}}),t("OutboundLink")],1)]),e._v(" "),t("blockquote",[t("p",[e._v("实用插件")])]),e._v(" "),t("ul",[t("li",[e._v("iOS专用：Xcode integration")]),e._v(" "),t("li",[e._v("Android专用：Gradle plugin")]),e._v(" "),t("li",[e._v("Gitlab插件：GitLab Plugin 和 Gitlab Hook Plugin")]),e._v(" "),t("li",[e._v("Git插件： Git plugin")]),e._v(" "),t("li",[e._v("GitBuckit插件： GitBuckit plugin")]),e._v(" "),t("li",[e._v("签名证书管理插件: Credentials Plugin 和Keychains and Provisioning Profiles Management")]),e._v(" "),t("li",[e._v("FTP插件: Publish over FTP")]),e._v(" "),t("li",[e._v("脚本插件: Post-Build Script Plug-in")]),e._v(" "),t("li",[e._v("修改Build名称/描述(二维码)： build-name-setter / description setter plugin")]),e._v(" "),t("li",[e._v("获取仓库提交的commit log： Git Changelog Plugin")]),e._v(" "),t("li",[e._v("自定义全局变量: Environment Injector Plugin")]),e._v(" "),t("li",[e._v("自定义邮件插件： Email Extension Plugin")]),e._v(" "),t("li",[e._v("获取当前登录用户信息： build-user-vars-plugin")]),e._v(" "),t("li",[e._v("显示代码测试覆盖率报表： Cobertura Plugin")]),e._v(" "),t("li",[e._v("来展示生成的单元测试报表，支持一切单测框架，如junit、nosetests等： Junit Plugin")]),e._v(" "),t("li",[e._v("其它： GIT plugin / SSH Credentials Plugin")])]),e._v(" "),t("h2",{attrs:{id:"jenkins系统设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins系统设置"}},[e._v("#")]),e._v(" Jenkins系统设置")]),e._v(" "),t("p",[e._v("操作： Manage Jenkins -> Configure System")]),e._v(" "),t("ul",[t("li",[e._v("Jenkins内部shell UTF-8 编码设置，如下图所示")])]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E8%AE%BE%E7%BD%AE1-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E8%AE%BE%E7%BD%AE1-min.png",alt:"img"}}),t("OutboundLink")],1)]),e._v(" "),t("ul",[t("li",[e._v("Jenkins Location和Email设置，如下图所示")])]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E8%AE%BE%E7%BD%AE2-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E8%AE%BE%E7%BD%AE2-min.png",alt:"img"}}),t("OutboundLink")],1)]),e._v(" "),t("ul",[t("li",[e._v("E-mail Notification，设置如下如所示")])]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkis%E7%B3%BB%E7%BB%9F%E8%AE%BE%E7%BD%AE3-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkis%E7%B3%BB%E7%BB%9F%E8%AE%BE%E7%BD%AE3-min.png",alt:"Jenkis系统设置3"}}),t("OutboundLink")],1),e._v("Jenkis系统设置3")]),e._v(" "),t("p",[e._v("SMTP详细配置请参考 "),t("a",{attrs:{href:"http://www.nailedtothex.org/roller/kyle/entry/articles-jenkins-email",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to send Email at every build with Jenkins"),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"jenkins-jobs配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-jobs配置"}},[e._v("#")]),e._v(" Jenkins Jobs配置")]),e._v(" "),t("h3",{attrs:{id:"jobs基础配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jobs基础配置"}},[e._v("#")]),e._v(" Jobs基础配置")]),e._v(" "),t("blockquote",[t("p",[e._v("配置编译参数")])]),e._v(" "),t("p",[e._v("例如，如果需要打包者自行选择打包类型，如需要编译Release/Debug/Test等不同版本的包，那需要配置Jobs的编译参数，配置方法如下图所示：")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE2-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE2-min.png",alt:"Jenkins编译设置-参数设置2"}}),t("OutboundLink")],1),e._v("Jenkins编译设置-参数设置2")]),e._v(" "),t("p",[e._v("你还可以配置一些其它参数，例如：")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE3-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE3-min.png",alt:"Jenkins编译设置-参数设置3"}}),t("OutboundLink")],1),e._v("Jenkins编译设置-参数设置3")]),e._v(" "),t("p",[e._v("配置完后，build界面中就会出现，如下如所示：")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE1-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE1-min.png",alt:"Jenkins编译设置-参数设置1"}}),t("OutboundLink")],1),e._v("Jenkins编译设置-参数设置1")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://stackoverflow.com/questions/7751735/how-to-configure-a-single-jenkins-job-to-make-the-release-process-from-trunk-or",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to configure a single Jenkins job to make the release process from trunk or branches?"),t("OutboundLink")],1)]),e._v(" "),t("blockquote",[t("p",[e._v("配置匿名用户权限")])]),e._v(" "),t("p",[e._v("后面打包的应用发布时，如果懒得自己搭建服务器，就用Jenkins的，但发布出去的链接需要登录才能访问，这时候你可以设置匿名用户的访问权限，这样匿名用户可以下载访问你提供的应用链接了，非常取巧的方法，如下图：")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE4-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E7%BC%96%E8%AF%91%E8%AE%BE%E7%BD%AE-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE4-min.png",alt:"Jenkins编译设置-参数设置4.png"}}),t("OutboundLink")],1),e._v("Jenkins编译设置-参数设置4.png")]),e._v(" "),t("h3",{attrs:{id:"jobs源码库配置-gitlab为例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jobs源码库配置-gitlab为例"}},[e._v("#")]),e._v(" Jobs源码库配置(Gitlab为例)")]),e._v(" "),t("blockquote",[t("p",[e._v("配置SSH")])]),e._v(" "),t("p",[e._v("操作： Manage Jenkins -> Credentials -> Global credentials (unrestricted) -> Add Credentials")]),e._v(" "),t("ol",[t("li",[e._v("本机生成SSH：ssh-keygen -t rsa -C “Your email” ， 生成过程中需设置密码，最终生成id_rsa和id_rsa.pub(公钥)")]),e._v(" "),t("li",[e._v("本机添加秘钥到SSH：ssh-add 文件名（需输入管理密码）")]),e._v(" "),t("li",[e._v("Gitlab上添加公钥：复制id_rsa.pub里面的公钥添加到Gitlab")]),e._v(" "),t("li",[e._v("Jenkins上配置密钥到SSH：复制id_rsa.pub里面的公钥添加到Jenkins（private key选项）")])]),e._v(" "),t("blockquote",[t("p",[e._v("新建Job")])]),e._v(" "),t("p",[e._v("在Jenkins中，所有的任务都是以”Job”为单位的。在进行操作前，你需要新建一个Job，Job新建比较简单，只需要在Jenkins管理的首页左侧，点击“New Job”，一般选择free-style software project，再输入Job的名字即可。")]),e._v(" "),t("blockquote",[t("p",[e._v("配置Gitlab")])]),e._v(" "),t("p",[e._v("在新建的任务（Jobs）中，Gitlab源码配置如下图：需要输入git仓库和build分支，公钥使用上面配置SSH生成的公钥。")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE1-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins-%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE1-min.png",alt:"img"}}),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"jobs触发条件配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jobs触发条件配置"}},[e._v("#")]),e._v(" Jobs触发条件配置")]),e._v(" "),t("p",[e._v("Jenkins支持多种触发器配置，包括：")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("定期进行构建（Build periodically），定时器使用示例如下：")]),e._v(" "),t("p",[e._v("H(25-30) 18 **1-5： 工作日下午6点25到30分之间进行build\nH 23 **1-5：工作日每晚23:00至23:59之间的某一时刻进行build\nH(0-29)/15 ****：前半小时内每隔15分钟进行build（开始时间不确定）\nH/20 ****：每隔20分钟进行build（开始时间不确定）")])]),e._v(" "),t("li",[t("p",[e._v("根据提交进行构建（Build when a change is pushed to GitHub）")])]),e._v(" "),t("li",[t("p",[e._v("定期检测代码更新，如有更新则进行构建（Poll SCM）")])])]),e._v(" "),t("h3",{attrs:{id:"jobs构建方式-编译-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jobs构建方式-编译-配置"}},[e._v("#")]),e._v(" Jobs构建方式/编译 配置")]),e._v(" "),t("p",[e._v("Jenkins支持多种编译配置方式，包括：")]),e._v(" "),t("ul",[t("li",[e._v("Xcode: iOS编译配置（安装Xcode integration插件）")]),e._v(" "),t("li",[e._v("Invoke Gradle script： Android编译配置(安装Gradle plugin插件)")]),e._v(" "),t("li",[e._v("Exceute Shell： 脚本方式")])]),e._v(" "),t("p",[e._v("对于iOS应用的构建，如果选择Xcode方式构建，需要配置好开发者证书，具体参考后面签名和整数问题。\n推荐使用Exceute Shell方式，简单有效。")]),e._v(" "),t("h3",{attrs:{id:"jobs构建后处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jobs构建后处理"}},[e._v("#")]),e._v(" Jobs构建后处理")]),e._v(" "),t("blockquote",[t("p",[e._v("Artifacts和邮件通知配置，参考下图")])]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE-Archive-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE-Archive-min.png",alt:"Jenkins项目设置-Archive-min"}}),t("OutboundLink")],1),e._v("Jenkins项目设置-Archive-min")]),e._v(" "),t("p",[e._v("可借助Email Extension Plugin 插件进行详细配置，具体可参考"),t("a",{attrs:{href:"http://blog.csdn.net/fengshi_sh/article/details/50669754",target:"_blank",rel:"noopener noreferrer"}},[e._v("此文"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE-%E9%82%AE%E4%BB%B6-min.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/Jenkins%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE-%E9%82%AE%E4%BB%B6-min.png",alt:"Jenkins项目设置-邮件-min"}}),t("OutboundLink")],1),e._v("Jenkins项目设置-邮件-min")]),e._v(" "),t("blockquote",[t("p",[e._v("发布")])]),e._v(" "),t("ul",[t("li",[e._v("FTP服务器, 最传统的方式，可助蒲公英或者fir.im（安装对应的Jenkins插件）。")]),e._v(" "),t("li",[e._v("专业的Artifacts存储仓库, 比如Nexus, Artifactory等。")]),e._v(" "),t("li",[e._v("对象存储服务：比如阿里云OSS，AWS S3等，以阿里云为例，具体请参考此文 "),t("a",{attrs:{href:"http://blog.fit2cloud.com/2015/01/20/aliyun-oss-jenkins-plugin.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("在Jenkins持续集成方案中使用阿里云OSS作为Artifacts仓库"),t("OutboundLink")],1)])]),e._v(" "),t("p",[e._v("当然，如果不想自己的应用发布到三方网站，只希望在自己的内网上托管，这样需要在自己内网上搭建服务器，服务器搭建方式有很多种，Mac上可以用自带的Apache服务，也可以用其它服务。")]),e._v(" "),t("p",[e._v("iOS的发布可能希望用到OTA，可参考"),t("a",{attrs:{href:"http://blog.csdn.net/close_marty/article/details/38559673",target:"_blank",rel:"noopener noreferrer"}},[e._v("此文"),t("OutboundLink")],1),e._v(" 还有这篇"),t("a",{attrs:{href:"http://www.jianshu.com/p/35ca63ec0d8e",target:"_blank",rel:"noopener noreferrer"}},[e._v("一步一步实现无线安装iOS应用(内网OTA)"),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("这里分享一个我写的shell脚本模板("),t("a",{attrs:{href:"https://github.com/skyseraph/PlistAutoCreate",target:"_blank",rel:"noopener noreferrer"}},[e._v("已开源"),t("OutboundLink")],1),e._v(")，可以用于iOS的plist文件自动创建以及OTA简单发布页面的自动创建，参考"),t("a",{attrs:{href:"https://github.com/skyseraph/PlistAutoCreate",target:"_blank",rel:"noopener noreferrer"}},[e._v("此链接获取源码"),t("OutboundLink")],1),e._v(", 欢迎Star.")]),e._v(" "),t("p",[e._v("自动生成一个简单HTML界面，如下图，点击Install即可安装：")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/jenkins_index.png",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/jenkins_index.png",alt:"Jenkis发布1"}}),t("OutboundLink")],1),e._v("Jenkis发布1")]),e._v(" "),t("p",[e._v("注意，这里iOS7.1以后限定必须要要用https，所以需要对jenkins设置下https，参考下面”后记” 中的Jenkins Https设置")]),e._v(" "),t("blockquote",[t("p",[e._v("Last Show")])]),e._v(" "),t("p",[e._v("构建成功后最终的结果如下如所示：")]),e._v(" "),t("p",[t("a",{attrs:{href:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/jenkins_finish.jpg",target:"_blank",rel:"noopener noreferrer"}},[t("img",{attrs:{src:"http://7xo4q8.com1.z0.glb.clouddn.com/skyseraph/2016/jenkins_finish.jpg",alt:"img"}}),t("OutboundLink")],1)]),e._v(" "),t("h1",{attrs:{id:"后记"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#后记"}},[e._v("#")]),e._v(" 后记")]),e._v(" "),t("h2",{attrs:{id:"签名和证书问题-ios"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#签名和证书问题-ios"}},[e._v("#")]),e._v(" 签名和证书问题(iOS)")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://circleci.com/docs/ios-code-signing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Set up code signing for iOS projects"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"http://eqi.cc/2016/05/17/%E5%AE%89%E8%A3%85jenkins%E5%88%B0%E5%8F%91%E5%B8%83ipa%E4%B8%AD%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9D%91/",target:"_blank",rel:"noopener noreferrer"}},[e._v("安装JENKINS到发布IPA中的那些坑"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"邮件发送失败"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#邮件发送失败"}},[e._v("#")]),e._v(" 邮件发送失败")]),e._v(" "),t("ul",[t("li",[e._v("实际搭建过程中有遇到此问题，折腾了小会，还以为是公司邮箱地址为题，后面发现仅仅是一个小配置问题。")]),e._v(" "),t("li",[e._v("Extended E-mail Notification中也需要和E-mail Notification一样，点击Advanced，然后选择Use SMTP Authentication，配置同E-mail Notification的参数。")])]),e._v(" "),t("h2",{attrs:{id:"jenkins-https-support"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-https-support"}},[e._v("#")]),e._v(" Jenkins Https Support")]),e._v(" "),t("p",[e._v("查询Jenkins Https相关命令：")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("java -jar jenkins.war --help "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("grep")]),e._v(" -i https\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("说明：下面以Mac为例.")]),e._v(" "),t("blockquote",[t("p",[e._v("KeyStore方式")])]),e._v(" "),t("ul",[t("li",[e._v("生成：")])]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("keytool -genkey -keyalg RSA -alias selfsigned -keystore keystore.jks -storepass 密码 -dname "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"cn=WEB"')]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ul",[t("li",[e._v("使用：")])]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("java -jar jenkins.war --httpPort"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("-1 --httpsPort"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("8080")]),e._v(" --httpsKeyStore"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/目录/keystore.jks --httpsKeyStorePassword"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("密码\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ul",[t("li",[e._v("注意： 第一次使用时需要将”WEB”证书导入，导入步骤为：Chrome导出证书 -> 安装证书 -> 设置证书”全部允许”， 图解步骤可参考下面实用参考中的第5篇文章.")])]),e._v(" "),t("blockquote",[t("p",[e._v("Certificate方式")])]),e._v(" "),t("ul",[t("li",[e._v("生成：")])]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" openssl genrsa -out server.key "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2048")]),e._v("  \n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" openssl req -new -key server.key -out server.csr  \n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" openssl genrsa  -out ca.key "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1024")]),e._v("  \n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" openssl req  -new -x509 -days "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("365")]),e._v(" -key ca.key -out ca.crt  \n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" openssl ca -in server.csr -out server.crt -cert ca.crt -keyfile ca.key\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("ul",[t("li",[e._v("使用：")])]),e._v(" "),t("p",[e._v("启动Jenkins:")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("java -jar jenkins.war --httpsPort"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("8088")]),e._v(" --httpsCertificate"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/path/server.crt --httpsPrivateKey"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/path/server.key\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ul",[t("li",[e._v("注意/说明：\n1 同上\n2 iOS手机需要导入cer证书(ca.crt)\n3 Common Name 填写IP地址或域名地址\n4 第5步骤如果提提示“I am unable to access the ./demoCA/newcerts directory” 错误，解决方法为：\n在当前操作目录，新建demoCA\\newcerts2层文件夹\n然后再demoCA文件夹下新建一个空的index.txt文件\n再新建一个serial文件，没有后缀。里面填入01")])]),e._v(" "),t("blockquote",[t("p",[e._v("实用参考")])]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://wiki.jenkins-ci.org/display/JENKINS/Starting+and+Accessing+Jenkins",target:"_blank",rel:"noopener noreferrer"}},[e._v("Starting and Accessing Jenkins"),t("OutboundLink")],1),e._v(" 官网说明")]),e._v(" "),t("li",[t("a",{attrs:{href:"http://balodeamit.blogspot.hk/2014/03/jenkins-switch-to-ssl-https-mode.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Jenkins: Switch to SSL/ HTTPS mode"),t("OutboundLink")],1),e._v(" 支持HTTPS的两种方式")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://wiki.wocommunity.org/display/documentation/Installing+and+Configuring+Jenkins",target:"_blank",rel:"noopener noreferrer"}},[e._v("Installing and Configuring Jenkins"),t("OutboundLink")],1),e._v(" KeyStore方式")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://discuss.zendesk.com/hc/en-us/articles/202652748-Generating-a-self-signed-SSL-certificate-using-the-Java-keytool-command-2004193-",target:"_blank",rel:"noopener noreferrer"}},[e._v("Generating a self-signed SSL certificate using the Java keytool command (2004193)"),t("OutboundLink")],1),e._v(" KeyStore方式")]),e._v(" "),t("li",[t("a",{attrs:{href:"http://www.andrewconnell.com/blog/setup-self-signed-certificates-trusting-them-on-os-x#ZAUu13DJEy2AYEYM.99",target:"_blank",rel:"noopener noreferrer"}},[e._v("Setup Self-Signed Certificates & Trusting them on OS X"),t("OutboundLink")],1),e._v(" Certificate方式")]),e._v(" "),t("li",[t("a",{attrs:{href:"http://nassir.iteye.com/blog/1983613",target:"_blank",rel:"noopener noreferrer"}},[e._v("免费openssl生成ssl证书"),t("OutboundLink")],1),e._v(" Certificate方式")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/hughperkins/howto-jenkins-ssl",target:"_blank",rel:"noopener noreferrer"}},[e._v("howto-jenkins-ssl"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://support.cloudbees.com/hc/en-us/articles/226744608-Jenkins-fails-to-Start-due-to-HttpsConnectorFactory",target:"_blank",rel:"noopener noreferrer"}},[e._v("Jenkins fails to Start due to HttpsConnectorFactory"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"http://yuur369.iteye.com/blog/1720321",target:"_blank",rel:"noopener noreferrer"}},[e._v("openssl 生成服务端证书所遇到的问题"),t("OutboundLink")],1)])]),e._v(" "),t("h1",{attrs:{id:"refs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#refs"}},[e._v("#")]),e._v(" Refs")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://wiki.jenkins-ci.org/display/JENKINS/Use+Jenkins",target:"_blank",rel:"noopener noreferrer"}},[e._v("Using Jenkins"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://wiki.jenkins-ci.org/display/JENKINS/Building+a+software+project",target:"_blank",rel:"noopener noreferrer"}},[e._v("Building a software project"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://danielbeard.wordpress.com/2013/04/23/auto-build-and-deploy-ios-apps-using-jenkins/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Auto build and deploy iOS apps using Jenkins"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"http://savvyapps.com/blog/continuous-integration-ios-jenkins",target:"_blank",rel:"noopener noreferrer"}},[e._v("Continuous Integration for iOS with Jenkins"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"http://docs.gitlab.com/ee/integration/jenkins.html#jenkins-ci-deprecated-service",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitLab Documentation"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://felixha.wordpress.com/2014/04/24/luu-bi/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Setup Jenkins + TestFlight for iOS apps"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://nickcharlton.net/posts/installing-jenkins-osx-yosemite.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Installing Jenkins on OS X Yosemite"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://www.ibm.com/developerworks/cn/java/j-lo-jenkins/",target:"_blank",rel:"noopener noreferrer"}},[e._v("基于 Jenkins 快速搭建持续集成环境"),t("OutboundLink")],1)]),e._v(" "),t("li",[e._v("[Jenkins入门](http://files.cnblogs")])])])}),[],!1,null,null,null);n.default=s.exports}}]);